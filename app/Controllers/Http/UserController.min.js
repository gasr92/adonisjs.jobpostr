"use strict";const User=use("App/Models/User");class UserController{async create({request:request,response:response,auth:auth}){const user=await User.create(request.only(["username","email","password"]));return await auth.login(user),response.redirect("/")}async login({request:request,auth:auth,response:response,session:session}){const{email:email,password:password}=request.all();try{return await auth.attempt(email,password),response.redirect("/")}catch(error){return session.flash({loginError:"These credentials do not work."}),response.redirect("/login")}}}module.exports=UserController;